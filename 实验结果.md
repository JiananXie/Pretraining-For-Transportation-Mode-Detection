###  实验结果

##### Bert-base-uncased:

![image-20231030102147575](C:\Users\谢嘉楠\AppData\Roaming\Typora\typora-user-images\image-20231030102147575.png)



10个epoch(pretrained bert-base-uncased)

| Epoch | train acc | val acc |
| ----- | --------- | ------- |
| 1     | 0.449     | 0.644   |
| 2     | 0.734     | 0.783   |
| 3     | 0.836     | 0.848   |
| 4     | 0.903     | 0.870   |
| 5     | 0.944     | 0.895   |
| 6     | 0.971     | 0.902   |
| 7     | 0.987     | 0.912   |
| 8     | 0.994     | 0.916   |
| 9     | 0.999     | 0.921   |
| 10    | 0.999     | 0.921   |

4个epoch(not pretrained bert-base-uncased)

| Epoch | train acc | val acc |
| ----- | --------- | ------- |
| 1     | 0.154     | 0.148   |
| 2     | 0.149     | 0.149   |
| 3     | 0.149     | 0.149   |
| 4     | 0.149     | 0.149   |





服务器结果：

（pretrained）

Epochs: 1
            | Train Loss:  0.715
            | Train Accuracy:  0.449
            | Val Loss:  0.451
            | Val Accuracy:  0.668
Epochs: 2
            | Train Loss:  0.372
            | Train Accuracy:  0.729
            | Val Loss:  0.304
            | Val Accuracy:  0.790
Epochs: 3
            | Train Loss:  0.228
            | Train Accuracy:  0.845
            | Val Loss:  0.214
            | Val Accuracy:  0.857
Epochs: 4
            | Train Loss:  0.139
            | Train Accuracy:  0.908
            | Val Loss:  0.173
            | Val Accuracy:  0.890
Epochs: 5
            | Train Loss:  0.079
            | Train Accuracy:  0.948
            | Val Loss:  0.166
            | Val Accuracy:  0.898
Epochs: 6
            | Train Loss:  0.044
            | Train Accuracy:  0.972
            | Val Loss:  0.156
            | Val Accuracy:  0.908

Epochs: 7
            | Train Loss:  0.022
            | Train Accuracy:  0.987
            | Val Loss:  0.163
            | Val Accuracy:  0.912
Epochs: 8
            | Train Loss:  0.010
            | Train Accuracy:  0.995
            | Val Loss:  0.173
            | Val Accuracy:  0.919
Epochs: 9
            | Train Loss:  0.004
            | Train Accuracy:  0.998
            | Val Loss:  0.169
            | Val Accuracy:  0.923
Epochs: 10
            | Train Loss:  0.002
            | Train Accuracy:  0.999
            | Val Loss:  0.168
            | Val Accuracy:  0.926

| Epoch | train acc | val acc |
| ----- | --------- | ------- |
| 1     | 0.449     | 0.668   |
| 2     | 0.729     | 0.790   |
| 3     | 0.845     | 0.857   |
| 4     | 0.908     | 0.890   |
| 5     | 0.948     | 0.898   |
| 6     | 0.972     | 0.908   |
| 7     | 0.987     | 0.912   |
| 8     | 0.995     | 0.919   |
| 9     | 0.998     | 0.923   |
| 10    | 0.999     | 0.926   |

（npretrained）

Epochs: 1
            | Train Loss:  1.040
            | Train Accuracy:  0.147
            | Val Loss:  1.040
            | Val Accuracy:  0.148
Epochs: 2
            | Train Loss:  1.040
            | Train Accuracy:  0.148
            | Val Loss:  1.040
            | Val Accuracy:  0.149
Epochs: 3
            | Train Loss:  1.040
            | Train Accuracy:  0.149
            | Val Loss:  1.040
            | Val Accuracy:  0.149
Epochs: 4
            | Train Loss:  1.040
            | Train Accuracy:  0.149
            | Val Loss:  1.040
            | Val Accuracy:  0.149
Epochs: 5
            | Train Loss:  1.040
            | Train Accuracy:  0.149
            | Val Loss:  1.040
            | Val Accuracy:  0.149
Epochs: 6
            | Train Loss:  1.040
            | Train Accuracy:  0.149
            | Val Loss:  1.040
            | Val Accuracy:  0.149

Epochs: 7
            | Train Loss:  1.040
            | Train Accuracy:  0.149
            | Val Loss:  1.040
            | Val Accuracy:  0.149
Epochs: 8
            | Train Loss:  1.040
            | Train Accuracy:  0.149
            | Val Loss:  1.040
            | Val Accuracy:  0.149
Epochs: 9
            | Train Loss:  1.040
            | Train Accuracy:  0.149
            | Val Loss:  1.040
            | Val Accuracy:  0.149
Epochs: 10
            | Train Loss:  1.040
            | Train Accuracy:  0.149
            | Val Loss:  1.040
            | Val Accuracy:  0.149

| Epoch | train acc | val acc |
| ----- | --------- | ------- |
| 1     | 0.147     | 0.148   |
| 2     | 0.148     | 0.149   |
| 3     | 0.149     | 0.149   |
| 4     | 0.149     | 0.149   |
| 5     | 0.149     | 0.149   |
| 6     | 0.149     | 0.149   |
| 7     | 0.149     | 0.149   |
| 8     | 0.149     | 0.149   |
| 9     | 0.149     | 0.149   |
| 10    | 0.149     | 0.149   |



加上optimizer.grad_zero()的train_preBert.py

Epochs: 1
            | Train Loss:  0.721
            | Train Accuracy:  0.436
            | Val Loss:  0.448
            | Val Accuracy:  0.653
Epochs: 2
            | Train Loss:  0.378
            | Train Accuracy:  0.724
            | Val Loss:  0.308
            | Val Accuracy:  0.785
Epochs: 3
            | Train Loss:  0.242
            | Train Accuracy:  0.832
            | Val Loss:  0.245
            | Val Accuracy:  0.831
Epochs: 4
            | Train Loss:  0.153
            | Train Accuracy:  0.895
            | Val Loss:  0.183
            | Val Accuracy:  0.880
Epochs: 5
            | Train Loss:  0.092
            | Train Accuracy:  0.939
            | Val Loss:  0.178
            | Val Accuracy:  0.892
Epochs: 6
            | Train Loss:  0.050
            | Train Accuracy:  0.969
            | Val Loss:  0.161
            | Val Accuracy:  0.904

Epochs: 7
            | Train Loss:  0.026
            | Train Accuracy:  0.984
            | Val Loss:  0.153
            | Val Accuracy:  0.915
Epochs: 8
            | Train Loss:  0.011
            | Train Accuracy:  0.994
            | Val Loss:  0.174
            | Val Accuracy:  0.916
Epochs: 9
            | Train Loss:  0.004
            | Train Accuracy:  0.999
            | Val Loss:  0.172
            | Val Accuracy:  0.922
Epochs: 10
            | Train Loss:  0.001
            | Train Accuracy:  1.000
            | Val Loss:  0.173
            | Val Accuracy:  0.925

| Epoch | train acc | val acc |
| ----- | --------- | ------- |
| 1     | 0.436     | 0.653   |
| 2     | 0.724     | 0.785   |
| 3     | 0.832     | 0.831   |
| 4     | 0.895     | 0.880   |
| 5     | 0.939     | 0.892   |
| 6     | 0.969     | 0.904   |
| 7     | 0.984     | 0.915   |
| 8     | 0.994     | 0.916   |
| 9     | 0.999     | 0.922   |
| 10    | 1.000     | 0.925   |



AdamW prebert
Epochs: 1 
            | Train Loss:  0.746     
            | Train Accuracy:  0.422 
            | Val Loss:  0.459       
            | Val Accuracy:  0.664   
Epochs: 2 
            | Train Loss:  0.374     
            | Train Accuracy:  0.728 
            | Val Loss:  0.296
            | Val Accuracy:  0.790
Epochs: 3 
            | Train Loss:  0.235
            | Train Accuracy:  0.839
            | Val Loss:  0.221
            | Val Accuracy:  0.854
Epochs: 4 
            | Train Loss:  0.142
            | Train Accuracy:  0.904
            | Val Loss:  0.182
            | Val Accuracy:  0.880
Epochs: 5 
            | Train Loss:  0.083
            | Train Accuracy:  0.944
            | Val Loss:  0.165
            | Val Accuracy:  0.891
Epochs: 6 
            | Train Loss:  0.046
            | Train Accuracy:  0.971
            | Val Loss:  0.174
            | Val Accuracy:  0.898
Epochs: 7 
            | Train Loss:  0.024
            | Train Accuracy:  0.986
            | Val Loss:  0.166
            | Val Accuracy:  0.916
Epochs: 8 
            | Train Loss:  0.012
            | Train Accuracy:  0.993
            | Val Loss:  0.172
            | Val Accuracy:  0.914
Epochs: 9 
            | Train Loss:  0.004
            | Train Accuracy:  0.998
            | Val Loss:  0.177
            | Val Accuracy:  0.921
Epochs: 10 
            | Train Loss:  0.002
            | Train Accuracy:  0.999
            | Val Loss:  0.178
            | Val Accuracy:  0.923

| Epoch | train acc | val acc |
| ----- | --------- | ------- |
| 1     | 0.422     | 0.664   |
| 2     | 0.728     | 0.790   |
| 3     | 0.839     | 0.854   |
| 4     | 0.904     | 0.880   |
| 5     | 0.944     | 0.891   |
| 6     | 0.971     | 0.898   |
| 7     | 0.986     | 0.916   |
| 8     | 0.993     | 0.914   |
| 9     | 0.998     | 0.921   |
| 10    | 0.999     | 0.923   |





from transformers import AutoConfig
config = AutoConfig.from_pretrained('bert-base-uncased')
model =  AutoModel.from_config(config)







6677：现在的npre，3epoch

Epochs: 1 
            | Train Loss:  1.040 
            | Train Accuracy:  0.146 
            | Val Loss:  1.040 
            | Val Accuracy:  0.149
Epochs: 2 
            | Train Loss:  1.040 
            | Train Accuracy:  0.149 
            | Val Loss:  1.040 
            | Val Accuracy:  0.149
Epochs: 3 
            | Train Loss:  1.040 
            | Train Accuracy:  0.149 
            | Val Loss:  1.040 
            | Val Accuracy:  0.149



6678：目前用于比较的preBert，3epoch

Epochs: 1 
            | Train Loss:  0.632 
            | Train Accuracy:  0.511 
            | Val Loss:  0.384 
            | Val Accuracy:  0.732
Epochs: 2 
            | Train Loss:  0.293 
            | Train Accuracy:  0.796 
            | Val Loss:  0.225 
            | Val Accuracy:  0.850
Epochs: 3 
            | Train Loss:  0.145 
            | Train Accuracy:  0.908 
            | Val Loss:  0.168 
            | Val Accuracy:  0.883





6705: 重新调整了之后的代码，跑10个epoches

Epochs: 1 
            | Train Loss:  0.818 
            | Train Accuracy:  0.338 
            | Val Loss:  0.549 
            | Val Accuracy:  0.573
Epochs: 2 
            | Train Loss:  0.463 
            | Train Accuracy:  0.646 
            | Val Loss:  0.371 
            | Val Accuracy:  0.726
Epochs: 3 
            | Train Loss:  0.336 
            | Train Accuracy:  0.756 
            | Val Loss:  0.272 
            | Val Accuracy:  0.808
Epochs: 4 
            | Train Loss:  0.253 
            | Train Accuracy:  0.822 
            | Val Loss:  0.236 
            | Val Accuracy:  0.831
Epochs: 5 
            | Train Loss:  0.199 
            | Train Accuracy:  0.862 
            | Val Loss:  0.189 
            | Val Accuracy:  0.875
Epochs: 6 
            | Train Loss:  0.155 
            | Train Accuracy:  0.896 
            | Val Loss:  0.172 
            | Val Accuracy:  0.887
Epochs: 7 
            | Train Loss:  0.118 
            | Train Accuracy:  0.922 
            | Val Loss:  0.162 
            | Val Accuracy:  0.900
Epochs: 8 
            | Train Loss:  0.089 
            | Train Accuracy:  0.943 
            | Val Loss:  0.158 
            | Val Accuracy:  0.903
Epochs: 9 
            | Train Loss:  0.068 
            | Train Accuracy:  0.958 
            | Val Loss:  0.150 
            | Val Accuracy:  0.910
Epochs: 10 
            | Train Loss:  0.054 
            | Train Accuracy:  0.965 
            | Val Loss:  0.147 
            | Val Accuracy:  0.912

6710：同样调整了之后的代码，但是没有预训练参数，10个epoches

Epochs: 1 
            | Train Loss:  1.040 
            | Train Accuracy:  0.149 
            | Val Loss:  1.040 
            | Val Accuracy:  0.149
Epochs: 2 
            | Train Loss:  1.040 
            | Train Accuracy:  0.149 
            | Val Loss:  1.040 
            | Val Accuracy:  0.149
Epochs: 3 
            | Train Loss:  1.040 
            | Train Accuracy:  0.149 
            | Val Loss:  1.040 
            | Val Accuracy:  0.149
Epochs: 4 
            | Train Loss:  1.040 
            | Train Accuracy:  0.149 
            | Val Loss:  1.040 
            | Val Accuracy:  0.149
Epochs: 5 
            | Train Loss:  1.040 
            | Train Accuracy:  0.149 
            | Val Loss:  1.040 
            | Val Accuracy:  0.149
Epochs: 6 
            | Train Loss:  1.040 
            | Train Accuracy:  0.149 
            | Val Loss:  1.040 
            | Val Accuracy:  0.149
Epochs: 7 
            | Train Loss:  1.040 
            | Train Accuracy:  0.149 
            | Val Loss:  1.040 
            | Val Accuracy:  0.149
Epochs: 8 
            | Train Loss:  1.040 
            | Train Accuracy:  0.149 
            | Val Loss:  1.040 
            | Val Accuracy:  0.149
Epochs: 9 
            | Train Loss:  1.040 
            | Train Accuracy:  0.149 
            | Val Loss:  1.040 
            | Val Accuracy:  0.149
Epochs: 10 
            | Train Loss:  1.040 
            | Train Accuracy:  0.149 
            | Val Loss:  1.040 
            | Val Accuracy:  0.149



6743 0.0001 lr 0.01预热 pre （出现了跟npre一样的情况）

6744 0.0001 lr 0.01预热 npre（这两次都出现了结果不变的情况）



6745 0.00001 lr 不预热  npre（与上面一样，猜测学习率大了，进入稳定了）





跑一组对照prebert，验证学习率过大问题：

6759: 1e-5学习率下， 0.1预热步数（目前较优的参数）

正常表现 0.8+

6760: 1e-4学习率下，0.01预热步数（之前跑是看起来学习率大了，进入稳定）

差不多是这个意思了，接下来调小学习率跑npre



先加长预热0.2(lr=1e-5)：

6780：pre

6781: npre

pre表现正常，npre没有什么效果



继续加长预热0.4(lr = 1e-5)

6798:pre 表现正常

6822:npre	(实验有误，忘了scheduler.step) (<font color="red">一直跑，有问题</font>)



加长预热到0.8(lr=1e-5)

6801:pre 准确率与之前比较为缓慢的从更小的值开始增加但第5个epoch差不多一样

6811:npre 	仍无变化



6826：1e-5 0.01预热步长，复现6760 (<font color='red'>6760实验有误，应该实际上lr=1e-4</font>)

***

考虑调小学习率：

1e-6 预热0.5：

6823: npre （有效果了）

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| ------ | ---------- | -------------- | -------- | ------------ |
| 1      | 1.040      | 0.150          | 1.033    | 0.172        |
| 2      | 1.037      | 0.168          | 1.030    | 0.172        |
| 3      | 0.849      | 0.315          | 0.692    | 0.449        |
| 4      | 0.670      | 0.466          | 0.616    | 0.515        |
| 5      | 0.627      | 0.503          | 0.606    | 0.514        |

6827：同参数，预训练比较

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| ------ | ---------- | -------------- | -------- | ------------ |
| 1      | 1.044      | 0.142          | 1.027    | 0.172        |
| 2      | 0.923      | 0.308          | 0.764    | 0.461        |
| 3      | 0.693      | 0.482          | 0.592    | 0.524        |
| 4      | 0.571      | 0.568          | 0.511    | 0.618        |
| 5      | 0.522      | 0.614          | 0.494    | 0.633        |



6828：复现6823，确保没有出错 (<font color='red'>6823没有错误</font>)

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| ------ | ---------- | -------------- | -------- | ------------ |
| 1      | 1.039      | 0.154          | 1.034    | 0.172        |
| 2      | 1.022      | 0.192          | 0.863    | 0.350        |
| 3      | 0.788      | 0.333          | 0.732    | 0.363        |
| 4      | 0.702      | 0.424          | 0.626    | 0.501        |
| 5      | 0.642      | 0.487          | 0.610    | 0.507        |

目前来看，在lr=1e-6, 预热步数为0.5时，预训练的bert在第3个epoch就可以超过未预训练的bert的第5个epoch

***

**下面工作：尽量使差距拉大，减少预热步数到0.1**

6837：pre

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| ------ | ---------- | -------------- | -------- | ------------ |
| 1      | 0.965      | 0.234          | 0.772    | 0.453        |
| 2      | 0.692      | 0.483          | 0.586    | 0.549        |
| 3      | 0.582      | 0.552          | 0.526    | 0.601        |
| 4      | 0.538      | 0.590          | 0.509    | 0.605        |
| 5      | 0.519      | 0.601          | 0.495    | 0.615        |

6838：npre

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| ------ | ---------- | -------------- | -------- | ------------ |
| 1      | 1.039      | 0.152          | 1.040    | 0.149        |
| 2      | 1.028      | 0.186          | 0.925    | 0.309        |
| 3      | 0.799      | 0.342          | 0.739    | 0.391        |
| 4      | 0.727      | 0.408          | 0.677    | 0.452        |
| 5      | 0.690      | 0.444          | 0.669    | 0.457        |



**此外比较上面0.5跑10个epochs的最终效果有无显著差距**

6839： pre

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| ------ | ---------- | -------------- | -------- | ------------ |
| 1      | 1.041      | 0.148          | 1.012    | 0.258        |
| 2      | 0.980      | 0.246          | 0.902    | 0.298        |
| 3      | 0.867      | 0.332          | 0.751    | 0.452        |
| 4      | 0.708      | 0.465          | 0.602    | 0.536        |
| 5      | 0.590      | 0.554          | 0.532    | 0.600        |
| 6      | 0.516      | 0.608          | 0.479    | 0.640        |
| 7      | 0.469      | 0.647          | 0.423    | 0.680        |
| 8      | 0.439      | 0.676          | 0.414    | 0.691        |
| 9      | 0.413      | 0.698          | 0.398    | 0.705        |
| 10     | 0.401      | 0.710          | 0.387    | 0.716        |

6840：npre

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| ------ | ---------- | -------------- | -------- | ------------ |
| 1      | 1.038      | 0.154          | 1.029    | 0.144        |
| 2      | 1.029      | 0.168          | 1.009    | 0.172        |
| 3      | 0.909      | 0.268          | 0.781    | 0.339        |
| 4      | 0.769      | 0.343          | 0.727    | 0.397        |
| 5      | 0.682      | 0.455          | 0.609    | 0.512        |
| 6      | 0.597      | 0.519          | 0.548    | 0.554        |
| 7      | 0.537      | 0.571          | 0.491    | 0.618        |
| 8      | 0.504      | 0.604          | 0.473    | 0.636        |
| 9      | 0.486      | 0.618          | 0.461    | 0.649        |
| 10     | 0.477      | 0.630          | 0.461    | 0.648        |



**预热步数：0.2**

6866: pre

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| ------ | ---------- | -------------- | -------- | ------------ |
| 1      | 1.024      | 0.189          | 0.915    | 0.350        |
| 2      | 0.780      | 0.428          | 0.640    | 0.510        |
| 3      | 0.639      | 0.508          | 0.587    | 0.534        |
| 4      | 0.581      | 0.551          | 0.532    | 0.587        |
| 5      | 0.553      | 0.577          | 0.518    | 0.600        |

6867: npre

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| ------ | ---------- | -------------- | -------- | ------------ |
| 1      | 1.039      | 0.156          | 1.039    | 0.149        |
| 2      | 0.940      | 0.247          | 0.766    | 0.317        |
| 3      | 0.741      | 0.380          | 0.695    | 0.447        |
| 4      | 0.673      | 0.457          | 0.642    | 0.490        |
| 5      | 0.638      | 0.491          | 0.623    | 0.507        |



**预热步数：0.05**

6880： pre

6881: npre

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| ------ | ---------- | -------------- | -------- | ------------ |
| 1      | 1.039      | 0.160          | 1.040    | 0.149        |
| 2      | 0.912      | 0.269          | 0.754    | 0.367        |
| 3      | 0.750      | 0.374          | 0.711    | 0.425        |
| 4      | 0.684      | 0.454          | 0.636    | 0.491        |
| 5      | 0.647      | 0.484          | 0.625    | 0.494        |

***

在上面表现较好的lr = 1e-6, warm up =0.1 steps上跑20个epochs以达到收敛

6902: pre

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| ------ | ---------- | -------------- | -------- | ------------ |
| 1      | 1.029      | 0.169          | 0.920    | 0.306        |
| 2      | 0.864      | 0.326          | 0.704    | 0.512        |
| 3      | 0.665      | 0.501          | 0.566    | 0.550        |
| 4      | 0.561      | 0.578          | 0.497    | 0.620        |
| 5      | 0.500      | 0.627          | 0.452    | 0.667        |
| 6      | 0.460      | 0.659          | 0.432    | 0.680        |
| 7      | 0.432      | 0.680          | 0.387    | 0.717        |
| 8      | 0.402      | 0.706          | 0.360    | 0.744        |
| 9      | 0.378      | 0.723          | 0.337    | 0.754        |
| 10     | 0.360      | 0.739          | 0.330    | 0.763        |
| 11     | 0.340      | 0.757          | 0.312    | 0.776        |
| 12     | 0.326      | 0.765          | 0.304    | 0.783        |
| 13     | 0.314      | 0.781          | 0.302    | 0.790        |
| 14     | 0.301      | 0.786          | 0.288    | 0.801        |
| 15     | 0.290      | 0.796          | 0.274    | 0.809        |
| 16     | 0.283      | 0.802          | 0.277    | 0.804        |
| 17     | 0.277      | 0.806          | 0.276    | 0.807        |
| 18     | 0.270      | 0.812          | 0.271    | 0.808        |
| 19     | 0.265      | 0.815          | 0.265    | 0.816        |
| 20     | 0.263      | 0.818          | 0.262    | 0.818        |

6903: npre

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| ------ | ---------- | -------------- | -------- | ------------ |
| 1      | 1.039      | 0.152          | 1.018    | 0.260        |
| 2      | 0.913      | 0.242          | 0.757    | 0.363        |
| 3      | 0.743      | 0.373          | 0.702    | 0.420        |
| 4      | 0.659      | 0.469          | 0.597    | 0.520        |
| 5      | 0.587      | 0.528          | 0.538    | 0.566        |
| 6      | 0.537      | 0.571          | 0.513    | 0.596        |
| 7      | 0.502      | 0.607          | 0.479    | 0.623        |
| 8      | 0.483      | 0.620          | 0.470    | 0.624        |
| 9      | 0.468      | 0.635          | 0.454    | 0.644        |
| 10     | 0.456      | 0.649          | 0.445    | 0.650        |
| 11     | 0.444      | 0.660          | 0.435    | 0.667        |
| 12     | 0.434      | 0.668          | 0.417    | 0.683        |
| 13     | 0.424      | 0.677          | 0.445    | 0.663        |
| 14     | 0.415      | 0.688          | 0.421    | 0.681        |
| 15     | 0.405      | 0.697          | 0.408    | 0.697        |
| 16     | 0.399      | 0.703          | 0.410    | 0.695        |
| 17     | 0.390      | 0.712          | 0.394    | 0.710        |
| 18     | 0.386      | 0.716          | 0.389    | 0.712        |
| 19     | 0.381      | 0.716          | 0.390    | 0.711        |
| 20     | 0.377      | 0.723          | 0.388    | 0.714        |



40个epoch：

6944： pre

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| ------ | ---------- | -------------- | -------- | ------------ |
| 1      | 1.040      | 0.155          | 1.026    | 0.156        |
| 2      | 1.004      | 0.219          | 0.889    | 0.332        |
| 3      | 0.817      | 0.401          | 0.682    | 0.485        |
| 4      | 0.649      | 0.508          | 0.562    | 0.560        |
| 5      | 0.554      | 0.579          | 0.493    | 0.622        |
| 6      | 0.497      | 0.622          | 0.445    | 0.667        |
| 7      | 0.458      | 0.653          | 0.413    | 0.693        |
| 8      | 0.427      | 0.682          | 0.388    | 0.711        |
| 9      | 0.398      | 0.706          | 0.388    | 0.709        |
| 10     | 0.373      | 0.728          | 0.336    | 0.758        |
| 11     | 0.347      | 0.747          | 0.303    | 0.785        |
| 12     | 0.324      | 0.770          | 0.296    | 0.788        |
| 13     | 0.305      | 0.781          | 0.292    | 0.794        |
| 14     | 0.285      | 0.798          | 0.257    | 0.822        |
| 15     | 0.265      | 0.813          | 0.261    | 0.815        |
| 16     | 0.252      | 0.823          | 0.251    | 0.827        |
| 17     | 0.242      | 0.831          | 0.237    | 0.838        |
| 18     | 0.226      | 0.842          | 0.231    | 0.842        |
| 19     | 0.212      | 0.855          | 0.221    | 0.854        |
| 20     | 0.208      | 0.858          | 0.212    | 0.863        |
| 21     | 0.195      | 0.864          | 0.218    | 0.856        |
| 22     | 0.189      | 0.872          | 0.219    | 0.853        |
| 23     | 0.180      | 0.878          | 0.207    | 0.863        |
| 24     | 0.172      | 0.883          | 0.209    | 0.864        |
| 25     | 0.168      | 0.887          | 0.201    | 0.870        |
| 26     | 0.162      | 0.891          | 0.197    | 0.873        |
| 27     | 0.153      | 0.896          | 0.203    | 0.871        |
| 28     | 0.147      | 0.902          | 0.193    | 0.878        |
| 29     | 0.142      | 0.906          | 0.201    | 0.872        |
| 30     | 0.140      | 0.906          | 0.183    | 0.883        |
| 31     | 0.135      | 0.910          | 0.189    | 0.878        |
| 32     | 0.128      | 0.916          | 0.184    | 0.886        |
| 33     | 0.128      | 0.915          | 0.187    | 0.883        |
| 34     | 0.124      | 0.918          | 0.184    | 0.888        |
| 35     | 0.122      | 0.918          | 0.183    | 0.885        |
| 36     | 0.122      | 0.918          | 0.183    | 0.885        |
| 37     | 0.119      | 0.920          | 0.183    | 0.887        |
| 38     | 0.118      | 0.923          | 0.182    | 0.887        |
| 39     | 0.115      | 0.925          | 0.182    | 0.886        |
| 40     | 0.115      | 0.924          | 0.183    | 0.887        |

6945： npre

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| ------ | ---------- | -------------- | -------- | ------------ |
| 1      | 1.040      | 0.148          | 1.028    | 0.172        |
| 2      | 1.031      | 0.173          | 0.992    | 0.242        |
| 3      | 0.830      | 0.300          | 0.741    | 0.375        |
| 4      | 0.741      | 0.374          | 0.679    | 0.440        |
| 5      | 0.643      | 0.477          | 0.595    | 0.520        |
| 6      | 0.567      | 0.547          | 0.512    | 0.595        |
| 7      | 0.516      | 0.589          | 0.497    | 0.599        |
| 8      | 0.487      | 0.615          | 0.473    | 0.622        |
| 9      | 0.469      | 0.633          | 0.445    | 0.660        |
| 10     | 0.452      | 0.651          | 0.442    | 0.660        |
| 11     | 0.438      | 0.666          | 0.425    | 0.682        |
| 12     | 0.423      | 0.678          | 0.423    | 0.685        |
| 13     | 0.413      | 0.690          | 0.417    | 0.699        |
| 14     | 0.402      | 0.700          | 0.397    | 0.704        |
| 15     | 0.383      | 0.711          | 0.380    | 0.720        |
| 16     | 0.369      | 0.729          | 0.387    | 0.713        |
| 17     | 0.356      | 0.735          | 0.354    | 0.745        |
| 18     | 0.341      | 0.749          | 0.348    | 0.748        |
| 19     | 0.332      | 0.756          | 0.321    | 0.765        |
| 20     | 0.322      | 0.762          | 0.331    | 0.759        |
| 21     | 0.312      | 0.772          | 0.304    | 0.775        |
| 22     | 0.304      | 0.778          | 0.313    | 0.774        |
| 23     | 0.300      | 0.783          | 0.298    | 0.779        |
| 24     | 0.289      | 0.789          | 0.296    | 0.788        |
| 25     | 0.283      | 0.793          | 0.294    | 0.785        |
| 26     | 0.276      | 0.799          | 0.304    | 0.782        |
| 27     | 0.271      | 0.804          | 0.299    | 0.786        |
| 28     | 0.268      | 0.806          | 0.300    | 0.788        |
| 29     | 0.260      | 0.812          | 0.299    | 0.789        |
| 30     | 0.255      | 0.815          | 0.291    | 0.793        |
| 31     | 0.250      | 0.818          | 0.278    | 0.799        |
| 32     | 0.248      | 0.820          | 0.281    | 0.799        |
| 33     | 0.244      | 0.824          | 0.273    | 0.800        |
| 34     | 0.240      | 0.829          | 0.278    | 0.801        |
| 35     | 0.238      | 0.830          | 0.273    | 0.805        |
| 36     | 0.233      | 0.835          | 0.274    | 0.803        |
| 37     | 0.230      | 0.838          | 0.276    | 0.804        |
| 38     | 0.229      | 0.839          | 0.270    | 0.807        |
| 39     | 0.225      | 0.841          | 0.268    | 0.808        |
| 40     | 0.225      | 0.840          | 0.268    | 0.808        |



复现0.1预热步数1e-6 lr下的数据（发现40个epochs下前5个与之前跑的效果不同）

6964: pre

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| ------ | ---------- | -------------- | -------- | ------------ |
| 1      | 0.967      | 0.224          | 0.817    | 0.315        |
| 2      | 0.735      | 0.430          | 0.637    | 0.492        |
| 3      | 0.620      | 0.521          | 0.569    | 0.558        |
| 4      | 0.575      | 0.555          | 0.537    | 0.584        |
| 5      | 0.551      | 0.577          | 0.528    | 0.593        |

6965: npre

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| ------ | ---------- | -------------- | -------- | ------------ |
| 1      | 1.038      | 0.160          | 1.026    | 0.288        |
| 2      | 0.836      | 0.310          | 0.743    | 0.398        |
| 3      | 0.719      | 0.410          | 0.669    | 0.465        |
| 4      | 0.665      | 0.471          | 0.635    | 0.494        |
| 5      | 0.639      | 0.492          | 0.627    | 0.499        |



40个epochs看不出收敛，调到50

6966： pre

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| ------ | ---------- | -------------- | -------- | ------------ |
| 1      | 1.047      | 0.150          | 1.015    | 0.243        |
| 2      | 0.999      | 0.224          | 0.912    | 0.326        |
| 3      | 0.886      | 0.325          | 0.782    | 0.437        |
| 4      | 0.742      | 0.455          | 0.612    | 0.536        |
| 5      | 0.601      | 0.547          | 0.541    | 0.577        |
| 6      | 0.518      | 0.613          | 0.451    | 0.663        |
| 7      | 0.468      | 0.647          | 0.413    | 0.701        |
| 8      | 0.429      | 0.683          | 0.382    | 0.733        |
| 9      | 0.394      | 0.715          | 0.357    | 0.741        |
| 10     | 0.365      | 0.739          | 0.321    | 0.775        |
| 11     | 0.336      | 0.766          | 0.307    | 0.789        |
| 12     | 0.311      | 0.779          | 0.295    | 0.796        |
| 13     | 0.289      | 0.799          | 0.265    | 0.819        |
| 14     | 0.268      | 0.814          | 0.256    | 0.826        |
| 15     | 0.251      | 0.833          | 0.247    | 0.835        |
| 16     | 0.233      | 0.841          | 0.232    | 0.844        |
| 17     | 0.217      | 0.854          | 0.227    | 0.843        |
| 18     | 0.205      | 0.861          | 0.228    | 0.844        |
| 19     | 0.190      | 0.874          | 0.201    | 0.865        |
| 20     | 0.177      | 0.880          | 0.197    | 0.863        |
| 21     | 0.167      | 0.888          | 0.204    | 0.864        |
| 22     | 0.159      | 0.895          | 0.195    | 0.872        |
| 23     | 0.148      | 0.902          | 0.197    | 0.871        |
| 24     | 0.139      | 0.909          | 0.194    | 0.873        |
| 25     | 0.131      | 0.915          | 0.186    | 0.881        |
| 26     | 0.124      | 0.919          | 0.177    | 0.887        |
| 27     | 0.119      | 0.924          | 0.177    | 0.886        |
| 28     | 0.111      | 0.929          | 0.189    | 0.881        |
| 29     | 0.105      | 0.932          | 0.183    | 0.886        |
| 30     | 0.099      | 0.937          | 0.173    | 0.895        |
| 31     | 0.095      | 0.938          | 0.172    | 0.892        |
| 32     | 0.089      | 0.941          | 0.173    | 0.893        |
| 33     | 0.082      | 0.949          | 0.169    | 0.899        |
| 34     | 0.081      | 0.949          | 0.170    | 0.897        |
| 35     | 0.076      | 0.952          | 0.168    | 0.899        |
| 36     | 0.073      | 0.954          | 0.165    | 0.899        |
| 37     | 0.070      | 0.957          | 0.170    | 0.899        |
| 38     | 0.069      | 0.957          | 0.165    | 0.904        |
| 39     | 0.064      | 0.959          | 0.166    | 0.903        |
| 40     | 0.062      | 0.962          | 0.174    | 0.901        |
| 41     | 0.061      | 0.962          | 0.175    | 0.900        |
| 42     | 0.059      | 0.962          | 0.165    | 0.904        |
| 43     | 0.056      | 0.964          | 0.170    | 0.901        |
| 44     | 0.055      | 0.965          | 0.166    | 0.906        |
| 45     | 0.055      | 0.964          | 0.166    | 0.905        |
| 46     | 0.051      | 0.968          | 0.165    | 0.904        |
| 47     | 0.051      | 0.968          | 0.164    | 0.906        |
| 48     | 0.048      | 0.970          | 0.168    | 0.905        |
| 49     | 0.050      | 0.970          | 0.166    | 0.903        |
| 50     | 0.047      | 0.971          | 0.166    | 0.904        |

6967: npre

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| ------ | ---------- | -------------- | -------- | ------------ |
| 1      | 1.038      | 0.159          | 1.031    | 0.172        |
| 2      | 1.031      | 0.170          | 1.010    | 0.240        |
| 3      | 0.905      | 0.262          | 0.792    | 0.350        |
| 4      | 0.791      | 0.338          | 0.733    | 0.424        |
| 5      | 0.695      | 0.432          | 0.621    | 0.498        |
| 6      | 0.606      | 0.517          | 0.537    | 0.576        |
| 7      | 0.541      | 0.574          | 0.512    | 0.584        |
| 8      | 0.497      | 0.612          | 0.492    | 0.616        |
| 9      | 0.479      | 0.628          | 0.458    | 0.652        |
| 10     | 0.458      | 0.646          | 0.445    | 0.652        |
| 11     | 0.447      | 0.660          | 0.476    | 0.631        |
| 12     | 0.435      | 0.666          | 0.450    | 0.663        |
| 13     | 0.423      | 0.678          | 0.413    | 0.694        |
| 14     | 0.411      | 0.689          | 0.399    | 0.710        |
| 15     | 0.396      | 0.703          | 0.383    | 0.722        |
| 16     | 0.382      | 0.715          | 0.378    | 0.724        |
| 17     | 0.364      | 0.732          | 0.365    | 0.737        |
| 18     | 0.352      | 0.742          | 0.344    | 0.748        |
| 19     | 0.338      | 0.753          | 0.342    | 0.753        |
| 20     | 0.323      | 0.764          | 0.347    | 0.753        |
| 21     | 0.313      | 0.771          | 0.313    | 0.774        |
| 22     | 0.304      | 0.782          | 0.314    | 0.774        |
| 23     | 0.290      | 0.792          | 0.305    | 0.778        |
| 24     | 0.284      | 0.796          | 0.305    | 0.781        |
| 25     | 0.276      | 0.802          | 0.289    | 0.792        |
| 26     | 0.267      | 0.807          | 0.284    | 0.793        |
| 27     | 0.259      | 0.815          | 0.283    | 0.804        |
| 28     | 0.250      | 0.822          | 0.276    | 0.804        |
| 29     | 0.245      | 0.823          | 0.273    | 0.802        |
| 30     | 0.237      | 0.835          | 0.281    | 0.799        |
| 31     | 0.232      | 0.837          | 0.280    | 0.801        |
| 32     | 0.226      | 0.840          | 0.260    | 0.816        |
| 33     | 0.218      | 0.846          | 0.273    | 0.801        |
| 34     | 0.215      | 0.849          | 0.259    | 0.820        |
| 35     | 0.207      | 0.854          | 0.251    | 0.826        |
| 36     | 0.204      | 0.855          | 0.251    | 0.828        |
| 37     | 0.199      | 0.862          | 0.258    | 0.819        |
| 38     | 0.196      | 0.860          | 0.257    | 0.822        |
| 39     | 0.192      | 0.865          | 0.253    | 0.828        |
| 40     | 0.188      | 0.869          | 0.251    | 0.827        |
| 41     | 0.185      | 0.869          | 0.245    | 0.833        |
| 42     | 0.183      | 0.870          | 0.249    | 0.831        |
| 43     | 0.179      | 0.875          | 0.245    | 0.831        |
| 44     | 0.175      | 0.879          | 0.247    | 0.835        |
| 45     | 0.173      | 0.880          | 0.247    | 0.833        |
| 46     | 0.172      | 0.881          | 0.241    | 0.833        |
| 47     | 0.169      | 0.883          | 0.250    | 0.833        |
| 48     | 0.167      | 0.886          | 0.244    | 0.837        |
| 49     | 0.167      | 0.886          | 0.242    | 0.836        |
| 50     | 0.166      | 0.886          | 0.243    | 0.836        |



再跑60个epoch：

7033： pre

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| ------ | ---------- | -------------- | -------- | ------------ |
| 1      | 1.040      | 0.150          | 1.034    | 0.171        |
| 2      | 1.027      | 0.182          | 1.008    | 0.235        |
| 3      | 0.917      | 0.321          | 0.775    | 0.439        |
| 4      | 0.738      | 0.464          | 0.617    | 0.532        |
| 5      | 0.610      | 0.541          | 0.528    | 0.592        |
| 6      | 0.528      | 0.604          | 0.493    | 0.618        |
| 7      | 0.478      | 0.641          | 0.433    | 0.673        |
| 8      | 0.441      | 0.673          | 0.389    | 0.715        |
| 9      | 0.401      | 0.707          | 0.384    | 0.721        |
| 10     | 0.366      | 0.739          | 0.338    | 0.765        |
| 11     | 0.337      | 0.761          | 0.311    | 0.783        |
| 12     | 0.303      | 0.788          | 0.278    | 0.808        |
| 13     | 0.276      | 0.809          | 0.263    | 0.820        |
| 14     | 0.254      | 0.825          | 0.235    | 0.839        |
| 15     | 0.232      | 0.842          | 0.222    | 0.852        |
| 16     | 0.210      | 0.854          | 0.209    | 0.857        |
| 17     | 0.193      | 0.873          | 0.238    | 0.845        |
| 18     | 0.181      | 0.878          | 0.189    | 0.875        |
| 19     | 0.164      | 0.888          | 0.199    | 0.871        |
| 20     | 0.149      | 0.900          | 0.191    | 0.872        |
| 21     | 0.136      | 0.910          | 0.186    | 0.884        |
| 22     | 0.127      | 0.917          | 0.173    | 0.892        |
| 23     | 0.117      | 0.922          | 0.176    | 0.891        |
| 24     | 0.111      | 0.927          | 0.174    | 0.891        |
| 25     | 0.099      | 0.936          | 0.178    | 0.893        |
| 26     | 0.092      | 0.938          | 0.174    | 0.897        |
| 27     | 0.085      | 0.944          | 0.170    | 0.899        |
| 28     | 0.081      | 0.947          | 0.170    | 0.895        |
| 29     | 0.072      | 0.954          | 0.170    | 0.903        |
| 30     | 0.067      | 0.956          | 0.170    | 0.901        |
| 31     | 0.063      | 0.959          | 0.164    | 0.910        |
| 32     | 0.059      | 0.962          | 0.164    | 0.912        |
| 33     | 0.054      | 0.966          | 0.168    | 0.912        |
| 34     | 0.050      | 0.968          | 0.169    | 0.907        |
| 35     | 0.047      | 0.969          | 0.169    | 0.908        |
| 36     | 0.042      | 0.974          | 0.175    | 0.910        |
| 37     | 0.039      | 0.976          | 0.164    | 0.916        |
| 38     | 0.038      | 0.976          | 0.177    | 0.910        |
| 39     | 0.034      | 0.978          | 0.167    | 0.914        |
| 40     | 0.033      | 0.980          | 0.166    | 0.916        |
| 41     | 0.030      | 0.982          | 0.169    | 0.912        |
| 42     | 0.028      | 0.984          | 0.173    | 0.912        |
| 43     | 0.027      | 0.984          | 0.172    | 0.912        |
| 44     | 0.025      | 0.985          | 0.165    | 0.918        |
| 45     | 0.024      | 0.985          | 0.172    | 0.913        |
| 46     | 0.022      | 0.987          | 0.173    | 0.920        |
| 47     | 0.021      | 0.987          | 0.175    | 0.914        |
| 48     | 0.019      | 0.988          | 0.177    | 0.916        |
| 49     | 0.020      | 0.988          | 0.171    | 0.916        |
| 50     | 0.019      | 0.989          | 0.174    | 0.918        |
| 51     | 0.017      | 0.990          | 0.178    | 0.917        |
| 52     | 0.016      | 0.991          | 0.176    | 0.917        |
| 53     | 0.017      | 0.990          | 0.175    | 0.917        |
| 54     | 0.015      | 0.991          | 0.178    | 0.919        |
| 55     | 0.015      | 0.992          | 0.179    | 0.916        |
| 56     | 0.013      | 0.993          | 0.179    | 0.919        |
| 57     | 0.014      | 0.992          | 0.178    | 0.920        |
| 58     | 0.013      | 0.993          | 0.181    | 0.920        |
| 59     | 0.013      | 0.993          | 0.178    | 0.920        |
| 60     | 0.013      | 0.993          | 0.179    | 0.920        |

7032： npre

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| ------ | ---------- | -------------- | -------- | ------------ |
| 1      | 1.041      | 0.151          | 1.031    | 0.172        |
| 2      | 1.033      | 0.160          | 1.018    | 0.172        |
| 3      | 0.945      | 0.239          | 0.782    | 0.361        |
| 4      | 0.777      | 0.330          | 0.728    | 0.401        |
| 5      | 0.719      | 0.399          | 0.644    | 0.463        |
| 6      | 0.619      | 0.503          | 0.555    | 0.563        |
| 7      | 0.566      | 0.546          | 0.581    | 0.543        |
| 8      | 0.530      | 0.579          | 0.497    | 0.592        |
| 9      | 0.502      | 0.601          | 0.480    | 0.622        |
| 10     | 0.483      | 0.621          | 0.474    | 0.618        |
| 11     | 0.467      | 0.637          | 0.460    | 0.640        |
| 12     | 0.451      | 0.656          | 0.425    | 0.678        |
| 13     | 0.440      | 0.661          | 0.420    | 0.673        |
| 14     | 0.426      | 0.677          | 0.445    | 0.664        |
| 15     | 0.411      | 0.691          | 0.434    | 0.678        |
| 16     | 0.397      | 0.703          | 0.393    | 0.708        |
| 17     | 0.381      | 0.716          | 0.373    | 0.726        |
| 18     | 0.363      | 0.733          | 0.363    | 0.732        |
| 19     | 0.351      | 0.739          | 0.348    | 0.748        |
| 20     | 0.340      | 0.747          | 0.357    | 0.739        |
| 21     | 0.327      | 0.761          | 0.318    | 0.772        |
| 22     | 0.317      | 0.766          | 0.336    | 0.755        |
| 23     | 0.307      | 0.774          | 0.323    | 0.767        |
| 24     | 0.299      | 0.781          | 0.299    | 0.788        |
| 25     | 0.288      | 0.790          | 0.300    | 0.787        |
| 26     | 0.282      | 0.795          | 0.296    | 0.789        |
| 27     | 0.275      | 0.800          | 0.304    | 0.780        |
| 28     | 0.268      | 0.809          | 0.294    | 0.794        |
| 29     | 0.262      | 0.810          | 0.283    | 0.797        |
| 30     | 0.254      | 0.818          | 0.290    | 0.797        |
| 31     | 0.247      | 0.822          | 0.272    | 0.808        |
| 32     | 0.240      | 0.829          | 0.295    | 0.800        |
| 33     | 0.233      | 0.833          | 0.278    | 0.802        |
| 34     | 0.227      | 0.838          | 0.265    | 0.816        |
| 35     | 0.222      | 0.843          | 0.294    | 0.801        |
| 36     | 0.217      | 0.847          | 0.289    | 0.808        |
| 37     | 0.210      | 0.851          | 0.256    | 0.823        |
| 38     | 0.205      | 0.856          | 0.245    | 0.834        |
| 39     | 0.199      | 0.860          | 0.251    | 0.828        |
| 40     | 0.192      | 0.865          | 0.256    | 0.830        |
| 41     | 0.189      | 0.870          | 0.260    | 0.822        |
| 42     | 0.184      | 0.872          | 0.244    | 0.842        |
| 43     | 0.178      | 0.876          | 0.247    | 0.835        |
| 44     | 0.173      | 0.882          | 0.243    | 0.843        |
| 45     | 0.170      | 0.881          | 0.247    | 0.833        |
| 46     | 0.166      | 0.885          | 0.237    | 0.847        |
| 47     | 0.163      | 0.887          | 0.244    | 0.844        |
| 48     | 0.159      | 0.891          | 0.235    | 0.846        |
| 49     | 0.158      | 0.894          | 0.237    | 0.845        |
| 50     | 0.152      | 0.895          | 0.228    | 0.850        |
| 51     | 0.150      | 0.899          | 0.234    | 0.850        |
| 52     | 0.148      | 0.899          | 0.237    | 0.847        |
| 53     | 0.145      | 0.899          | 0.235    | 0.850        |
| 54     | 0.143      | 0.903          | 0.232    | 0.850        |
| 55     | 0.141      | 0.902          | 0.245    | 0.843        |
| 56     | 0.139      | 0.906          | 0.230    | 0.854        |
| 57     | 0.138      | 0.908          | 0.231    | 0.854        |
| 58     | 0.135      | 0.908          | 0.232    | 0.852        |
| 59     | 0.136      | 0.908          | 0.230    | 0.854        |
| 60     | 0.132      | 0.910          | 0.231    | 0.851        |



7066：

npre 80个

0.89

***

分类训练、验证、测试之后从头跑一遍 0.1预热，1e-6学习率

5epochs:

7182: pre

test_acc:<font color='red'> 0.591</font>

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy                   |
| ------ | ---------- | -------------- | -------- | ------------------------------ |
| 1      | 1.004      | 0.205          | 0.818    | 0.385                          |
| 2      | 0.742      | 0.455          | 0.624    | <font color='red'>0.526</font> |
| 3      | 0.620      | 0.531          | 0.561    | 0.560                          |
| 4      | 0.575      | 0.565          | 0.528    | 0.589                          |
| 5      | 0.556      | 0.582          | 0.522    | 0.592                          |

7183: npre

test_acc: <font color='red'>0.473</font>

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy                   |
| ------ | ---------- | -------------- | -------- | ------------------------------ |
| 1      | 1.039      | 0.159          | 1.036    | 0.172                          |
| 2      | 1.006      | 0.211          | 0.862    | 0.345                          |
| 3      | 0.790      | 0.373          | 0.724    | 0.414                          |
| 4      | 0.718      | 0.420          | 0.698    | 0.439                          |
| 5      | 0.684      | 0.449          | 0.669    | <font color='red'>0.460</font> |



10epochs：

7090： pre

<font color='red'>test acc: 0.688</font>

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy                   |
| ------ | ---------- | -------------- | -------- | ------------------------------ |
| 1      | 1.029      | 0.176          | 0.944    | 0.297                          |
| 2      | 0.789      | 0.410          | 0.639    | 0.511                          |
| 3      | 0.623      | 0.524          | 0.549    | 0.580                          |
| 4      | 0.551      | 0.576          | 0.536    | 0.593                          |
| 5      | 0.511      | 0.610          | 0.486    | <font color='red'>0.626</font> |
| 6      | 0.487      | 0.629          | 0.471    | 0.641                          |
| 7      | 0.467      | 0.646          | 0.442    | 0.673                          |
| 8      | 0.450      | 0.659          | 0.435    | 0.675                          |
| 9      | 0.440      | 0.670          | 0.431    | 0.678                          |
| 10     | 0.434      | 0.674          | 0.424    | 0.685                          |

7091 : npre

<font color ='red'>test_acc:  0.607</font>

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy                   |
| ------ | ---------- | -------------- | -------- | ------------------------------ |
| 1      | 1.039      | 0.153          | 1.040    | 0.148                          |
| 2      | 0.967      | 0.210          | 0.770    | 0.383                          |
| 3      | 0.754      | 0.359          | 0.682    | 0.425                          |
| 4      | 0.667      | 0.459          | 0.618    | 0.503                          |
| 5      | 0.603      | 0.514          | 0.559    | 0.548                          |
| 6      | 0.558      | 0.550          | 0.528    | 0.585                          |
| 7      | 0.528      | 0.580          | 0.497    | 0.602                          |
| 8      | 0.511      | 0.596          | 0.488    | 0.615                          |
| 9      | 0.499      | 0.604          | 0.485    | 0.627                          |
| 10     | 0.493      | 0.610          | 0.493    | <font color='red'>0.615</font> |



70 epochs:

7104: pre

test_acc: <font color='red'>0.916</font>

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| ------ | ---------- | -------------- | -------- | ------------ |
| 1      | 1.048      | 0.128          | 1.028    | 0.160        |
| 2      | 1.028      | 0.177          | 0.983    | 0.265        |
| 3      | 0.971      | 0.254          | 0.889    | 0.297        |
| 4      | 0.840      | 0.364          | 0.720    | 0.490        |
| 5      | 0.698      | 0.480          | 0.604    | 0.534        |
| 6      | 0.606      | 0.531          | 0.539    | 0.586        |
| 7      | 0.539      | 0.588          | 0.488    | 0.640        |
| 8      | 0.488      | 0.634          | 0.450    | 0.659        |
| 9      | 0.452      | 0.659          | 0.404    | 0.702        |
| 10     | 0.421      | 0.686          | 0.376    | 0.723        |
| 11     | 0.393      | 0.708          | 0.354    | 0.740        |
| 12     | 0.369      | 0.729          | 0.326    | 0.764        |
| 13     | 0.345      | 0.750          | 0.314    | 0.776        |
| 14     | 0.325      | 0.766          | 0.290    | 0.795        |
| 15     | 0.303      | 0.781          | 0.277    | 0.808        |
| 16     | 0.285      | 0.797          | 0.259    | 0.814        |
| 17     | 0.267      | 0.812          | 0.247    | 0.829        |
| 18     | 0.255      | 0.820          | 0.236    | 0.839        |
| 19     | 0.238      | 0.835          | 0.234    | 0.840        |
| 20     | 0.224      | 0.843          | 0.224    | 0.851        |
| 21     | 0.210      | 0.851          | 0.212    | 0.860        |
| 22     | 0.199      | 0.862          | 0.212    | 0.860        |
| 23     | 0.187      | 0.871          | 0.204    | 0.868        |
| 24     | 0.177      | 0.878          | 0.201    | 0.870        |
| 25     | 0.167      | 0.888          | 0.190    | 0.881        |
| 26     | 0.158      | 0.893          | 0.187    | 0.884        |
| 27     | 0.152      | 0.897          | 0.188    | 0.888        |
| 28     | 0.142      | 0.905          | 0.187    | 0.885        |
| 29     | 0.134      | 0.910          | 0.173    | 0.889        |
| 30     | 0.127      | 0.915          | 0.178    | 0.891        |
| 31     | 0.122      | 0.919          | 0.173    | 0.893        |
| 32     | 0.119      | 0.923          | 0.169    | 0.896        |
| 33     | 0.106      | 0.931          | 0.173    | 0.898        |
| 34     | 0.102      | 0.933          | 0.167    | 0.899        |
| 35     | 0.100      | 0.935          | 0.171    | 0.900        |
| 36     | 0.094      | 0.938          | 0.173    | 0.902        |
| 37     | 0.088      | 0.942          | 0.167    | 0.899        |
| 38     | 0.083      | 0.946          | 0.171    | 0.896        |
| 39     | 0.081      | 0.947          | 0.168    | 0.899        |
| 40     | 0.078      | 0.949          | 0.159    | 0.906        |
| 41     | 0.075      | 0.951          | 0.170    | 0.899        |
| 42     | 0.072      | 0.954          | 0.161    | 0.911        |
| 43     | 0.069      | 0.954          | 0.167    | 0.908        |
| 44     | 0.065      | 0.960          | 0.177    | 0.903        |
| 45     | 0.060      | 0.961          | 0.161    | 0.906        |
| 46     | 0.061      | 0.961          | 0.162    | 0.909        |
| 47     | 0.055      | 0.967          | 0.168    | 0.908        |
| 48     | 0.053      | 0.967          | 0.174    | 0.903        |
| 49     | 0.053      | 0.966          | 0.157    | 0.912        |
| 50     | 0.048      | 0.971          | 0.168    | 0.908        |
| 51     | 0.048      | 0.969          | 0.170    | 0.909        |
| 52     | 0.045      | 0.973          | 0.167    | 0.911        |
| 53     | 0.044      | 0.972          | 0.172    | 0.908        |
| 54     | 0.043      | 0.973          | 0.168    | 0.910        |
| 55     | 0.041      | 0.975          | 0.170    | 0.910        |
| 56     | 0.041      | 0.975          | 0.166    | 0.911        |
| 57     | 0.039      | 0.976          | 0.164    | 0.914        |
| 58     | 0.038      | 0.977          | 0.166    | 0.910        |
| 59     | 0.036      | 0.977          | 0.169    | 0.912        |
| 60     | 0.036      | 0.978          | 0.163    | 0.911        |
| 61     | 0.035      | 0.978          | 0.168    | 0.913        |
| 62     | 0.035      | 0.979          | 0.162    | 0.913        |
| 63     | 0.033      | 0.980          | 0.167    | 0.914        |
| 64     | 0.032      | 0.980          | 0.166    | 0.914        |
| 65     | 0.032      | 0.980          | 0.168    | 0.914        |
| 66     | 0.032      | 0.980          | 0.165    | 0.916        |
| 67     | 0.030      | 0.981          | 0.166    | 0.916        |
| 68     | 0.030      | 0.982          | 0.166    | 0.917        |
| 69     | 0.030      | 0.982          | 0.166    | 0.916        |
| 70     | 0.030      | 0.982          | 0.166    | 0.915        |

7105: npre

test_acc: <font color='red'>0.858</font>

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| ------ | ---------- | -------------- | -------- | ------------ |
| 1      | 1.041      | 0.143          | 1.034    | 0.172        |
| 2      | 1.035      | 0.164          | 1.029    | 0.173        |
| 3      | 1.023      | 0.188          | 0.982    | 0.227        |
| 4      | 0.845      | 0.308          | 0.756    | 0.368        |
| 5      | 0.749      | 0.370          | 0.698    | 0.432        |
| 6      | 0.671      | 0.457          | 0.596    | 0.526        |
| 7      | 0.597      | 0.520          | 0.548    | 0.553        |
| 8      | 0.546      | 0.565          | 0.508    | 0.592        |
| 9      | 0.506      | 0.600          | 0.508    | 0.593        |
| 10     | 0.482      | 0.622          | 0.480    | 0.636        |
| 11     | 0.467      | 0.633          | 0.454    | 0.645        |
| 12     | 0.449      | 0.651          | 0.439    | 0.671        |
| 13     | 0.437      | 0.665          | 0.429    | 0.683        |
| 14     | 0.419      | 0.682          | 0.416    | 0.701        |
| 15     | 0.402      | 0.699          | 0.394    | 0.710        |
| 16     | 0.382      | 0.718          | 0.374    | 0.733        |
| 17     | 0.366      | 0.729          | 0.365    | 0.744        |
| 18     | 0.351      | 0.738          | 0.367    | 0.740        |
| 19     | 0.338      | 0.750          | 0.353    | 0.751        |
| 20     | 0.324      | 0.763          | 0.350    | 0.757        |
| 21     | 0.315      | 0.769          | 0.338    | 0.767        |
| 22     | 0.304      | 0.777          | 0.315    | 0.785        |
| 23     | 0.296      | 0.783          | 0.306    | 0.792        |
| 24     | 0.288      | 0.794          | 0.299    | 0.793        |
| 25     | 0.278      | 0.799          | 0.297    | 0.788        |
| 26     | 0.269      | 0.806          | 0.295    | 0.797        |
| 27     | 0.263      | 0.810          | 0.289    | 0.801        |
| 28     | 0.253      | 0.817          | 0.292    | 0.802        |
| 29     | 0.246      | 0.824          | 0.279    | 0.807        |
| 30     | 0.237      | 0.832          | 0.269    | 0.820        |
| 31     | 0.231      | 0.836          | 0.298    | 0.800        |
| 32     | 0.224      | 0.841          | 0.271    | 0.822        |
| 33     | 0.218      | 0.846          | 0.261    | 0.829        |
| 34     | 0.210      | 0.851          | 0.269    | 0.827        |
| 35     | 0.201      | 0.860          | 0.279    | 0.811        |
| 36     | 0.193      | 0.865          | 0.270    | 0.824        |
| 37     | 0.188      | 0.868          | 0.250    | 0.837        |
| 38     | 0.181      | 0.874          | 0.268    | 0.827        |
| 39     | 0.176      | 0.879          | 0.260    | 0.835        |
| 40     | 0.170      | 0.881          | 0.243    | 0.843        |
| 41     | 0.166      | 0.885          | 0.253    | 0.840        |
| 42     | 0.160      | 0.888          | 0.245    | 0.848        |
| 43     | 0.155      | 0.891          | 0.245    | 0.846        |
| 44     | 0.151      | 0.896          | 0.243    | 0.848        |
| 45     | 0.146      | 0.899          | 0.255    | 0.841        |
| 46     | 0.138      | 0.903          | 0.256    | 0.841        |
| 47     | 0.137      | 0.905          | 0.245    | 0.850        |
| 48     | 0.134      | 0.907          | 0.251    | 0.846        |
| 49     | 0.132      | 0.908          | 0.250    | 0.846        |
| 50     | 0.125      | 0.915          | 0.237    | 0.854        |
| 51     | 0.119      | 0.920          | 0.255    | 0.847        |
| 52     | 0.118      | 0.920          | 0.238    | 0.859        |
| 53     | 0.116      | 0.920          | 0.241    | 0.859        |
| 54     | 0.113      | 0.923          | 0.243    | 0.856        |
| 55     | 0.109      | 0.925          | 0.241    | 0.855        |
| 56     | 0.106      | 0.929          | 0.235    | 0.861        |
| 57     | 0.103      | 0.931          | 0.247    | 0.854        |
| 58     | 0.100      | 0.933          | 0.240    | 0.859        |
| 59     | 0.100      | 0.932          | 0.243    | 0.857        |
| 60     | 0.097      | 0.933          | 0.236    | 0.863        |
| 61     | 0.093      | 0.939          | 0.242    | 0.858        |
| 62     | 0.092      | 0.938          | 0.235    | 0.864        |
| 63     | 0.094      | 0.936          | 0.241    | 0.863        |
| 64     | 0.089      | 0.941          | 0.238    | 0.865        |
| 65     | 0.087      | 0.942          | 0.243    | 0.863        |
| 66     | 0.089      | 0.940          | 0.234    | 0.869        |
| 67     | 0.083      | 0.943          | 0.238    | 0.866        |
| 68     | 0.085      | 0.942          | 0.238    | 0.865        |
| 69     | 0.083      | 0.945          | 0.236    | 0.867        |
| 70     | 0.081      | 0.947          | 0.237    | 0.867        |



100 epochs:

7115: pre 

test_acc: <font color='red'>0.924</font>

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| ------ | ---------- | -------------- | -------- | ------------ |
| 81     | 0.008      | 0.995          | 0.217    | 0.917        |
| 82     | 0.008      | 0.995          | 0.211    | 0.916        |
| 83     | 0.007      | 0.996          | 0.218    | 0.913        |
| 84     | 0.007      | 0.996          | 0.216    | 0.917        |
| 85     | 0.007      | 0.996          | 0.215    | 0.913        |
| 86     | 0.006      | 0.996          | 0.216    | 0.918        |
| 87     | 0.006      | 0.997          | 0.215    | 0.918        |
| 88     | 0.006      | 0.997          | 0.215    | 0.915        |
| 89     | 0.006      | 0.996          | 0.222    | 0.916        |
| 90     | 0.005      | 0.998          | 0.216    | 0.915        |
| 91     | 0.006      | 0.996          | 0.220    | 0.915        |
| 92     | 0.006      | 0.997          | 0.218    | 0.915        |
| 93     | 0.005      | 0.998          | 0.218    | 0.915        |
| 94     | 0.005      | 0.997          | 0.216    | 0.915        |
| 95     | 0.005      | 0.997          | 0.219    | 0.917        |
| 96     | 0.005      | 0.997          | 0.219    | 0.916        |
| 97     | 0.005      | 0.997          | 0.220    | 0.916        |
| 98     | 0.004      | 0.998          | 0.218    | 0.916        |
| 99     | 0.004      | 0.998          | 0.221    | 0.915        |
| 100    | 0.006      | 0.997          | 0.220    | 0.914        |

7116: npre

test_acc: <font color='red'>0.891</font>

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| ------ | ---------- | -------------- | -------- | ------------ |
| 81     | 0.021      | 0.987          | 0.271    | 0.885        |
| 82     | 0.021      | 0.987          | 0.273    | 0.889        |
| 83     | 0.019      | 0.989          | 0.279    | 0.888        |
| 84     | 0.019      | 0.990          | 0.282    | 0.886        |
| 85     | 0.018      | 0.989          | 0.293    | 0.884        |
| 86     | 0.018      | 0.990          | 0.280    | 0.889        |
| 87     | 0.017      | 0.991          | 0.286    | 0.887        |
| 88     | 0.016      | 0.991          | 0.285    | 0.888        |
| 89     | 0.015      | 0.992          | 0.284    | 0.886        |
| 90     | 0.015      | 0.992          | 0.295    | 0.888        |
| 91     | 0.014      | 0.992          | 0.289    | 0.886        |
| 92     | 0.014      | 0.993          | 0.287    | 0.889        |
| 93     | 0.014      | 0.994          | 0.291    | 0.886        |
| 94     | 0.013      | 0.993          | 0.292    | 0.888        |
| 95     | 0.014      | 0.993          | 0.288    | 0.890        |
| 96     | 0.013      | 0.993          | 0.286    | 0.892        |
| 97     | 0.012      | 0.994          | 0.289    | 0.888        |
| 98     | 0.012      | 0.994          | 0.289    | 0.887        |
| 99     | 0.012      | 0.994          | 0.289    | 0.889        |
| 100    | 0.012      | 0.995          | 0.289    | 0.888        |



120 epochs pre:

test_acc:<font color='red'>0.918</font>

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| ------ | ---------- | -------------- | -------- | ------------ |
| 111    | 0.002      | 0.999          | 0.243    | 0.918        |
| 112    | 0.002      | 0.999          | 0.243    | 0.916        |
| 113    | 0.002      | 0.999          | 0.242    | 0.918        |
| 114    | 0.002      | 0.999          | 0.241    | 0.920        |
| 115    | 0.002      | 0.999          | 0.241    | 0.920        |
| 116    | 0.001      | 0.999          | 0.245    | 0.918        |
| 117    | 0.002      | 0.999          | 0.241    | 0.920        |
| 118    | 0.001      | 0.999          | 0.242    | 0.920        |
| 119    | 0.002      | 0.999          | 0.240    | 0.919        |
| 120    | 0.002      | 0.999          | 0.241    | 0.920        |



130 epochs npre:

test_acc:<font color='red'> 0.890</font>

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| ------ | ---------- | -------------- | -------- | ------------ |
| 121    | 0.005      | 0.998          | 0.315    | 0.893        |
| 122    | 0.005      | 0.998          | 0.321    | 0.891        |
| 123    | 0.004      | 0.998          | 0.316    | 0.889        |
| 124    | 0.004      | 0.998          | 0.312    | 0.893        |
| 125    | 0.004      | 0.998          | 0.316    | 0.893        |
| 126    | 0.004      | 0.998          | 0.319    | 0.890        |
| 127    | 0.004      | 0.998          | 0.318    | 0.892        |
| 128    | 0.004      | 0.999          | 0.316    | 0.890        |
| 129    | 0.004      | 0.998          | 0.316    | 0.893        |
| 130    | 0.004      | 0.998          | 0.316    | 0.893        |





***

考虑前五维时序做预测：

5 epochs, 1e-6

test_acc:<font color='red'> 0.830</font>

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| :----- | :--------- | :------------- | :------- | :----------- |
| 1      | 0.832      | 0.401          | 0.517    | 0.625        |
| 2      | 0.488      | 0.648          | 0.390    | 0.740        |
| 3      | 0.390      | 0.727          | 0.310    | 0.792        |
| 4      | 0.330      | 0.778          | 0.276    | 0.817        |
| 5      | 0.302      | 0.799          | 0.267    | 0.824        |



40 epochs, 1e-6

test_acc:<font color='red'> 0.947</font>

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| :----- | :--------- | :------------- | :------- | :----------- |
| 1      | 1.044      | 0.245          | 0.769    | 0.463        |
| 2      | 0.655      | 0.522          | 0.518    | 0.633        |
| 3      | 0.507      | 0.625          | 0.400    | 0.731        |
| 4      | 0.396      | 0.720          | 0.318    | 0.774        |
| 5      | 0.298      | 0.800          | 0.231    | 0.852        |
| 6      | 0.232      | 0.846          | 0.196    | 0.873        |
| 7      | 0.192      | 0.874          | 0.162    | 0.899        |
| 8      | 0.164      | 0.895          | 0.143    | 0.910        |
| 9      | 0.141      | 0.911          | 0.140    | 0.913        |
| 10     | 0.126      | 0.922          | 0.117    | 0.929        |
| 11     | 0.109      | 0.931          | 0.123    | 0.925        |
| 12     | 0.099      | 0.937          | 0.107    | 0.931        |
| 13     | 0.087      | 0.944          | 0.099    | 0.939        |
| 14     | 0.081      | 0.951          | 0.100    | 0.939        |
| 15     | 0.072      | 0.955          | 0.097    | 0.943        |
| 16     | 0.065      | 0.958          | 0.095    | 0.946        |
| 17     | 0.060      | 0.963          | 0.095    | 0.942        |
| 18     | 0.053      | 0.969          | 0.088    | 0.947        |
| 19     | 0.049      | 0.970          | 0.091    | 0.950        |
| 20     | 0.043      | 0.974          | 0.092    | 0.952        |
| 21     | 0.040      | 0.976          | 0.093    | 0.949        |
| 22     | 0.036      | 0.980          | 0.096    | 0.944        |
| 23     | 0.032      | 0.982          | 0.094    | 0.948        |
| 24     | 0.030      | 0.983          | 0.094    | 0.948        |
| 25     | 0.027      | 0.985          | 0.095    | 0.948        |
| 26     | 0.024      | 0.987          | 0.096    | 0.948        |
| 27     | 0.022      | 0.988          | 0.094    | 0.952        |
| 28     | 0.020      | 0.989          | 0.097    | 0.950        |
| 29     | 0.018      | 0.990          | 0.100    | 0.947        |
| 30     | 0.017      | 0.991          | 0.103    | 0.947        |
| 31     | 0.015      | 0.992          | 0.099    | 0.950        |
| 32     | 0.015      | 0.993          | 0.099    | 0.947        |
| 33     | 0.014      | 0.994          | 0.103    | 0.949        |
| 34     | 0.012      | 0.994          | 0.100    | 0.950        |
| 35     | 0.012      | 0.995          | 0.101    | 0.948        |
| 36     | 0.010      | 0.996          | 0.100    | 0.952        |
| 37     | 0.010      | 0.996          | 0.099    | 0.950        |
| 38     | 0.010      | 0.996          | 0.100    | 0.950        |
| 39     | 0.009      | 0.996          | 0.100    | 0.952        |
| 40     | 0.009      | 0.996          | 0.100    | 0.951        |



5epochs 1^e-5:

test_acc: <font color='red'>0.953</font>	

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| :----- | :--------- | :------------- | :------- | :----------- |
| 1      | 0.590      | 0.571          | 0.285    | 0.809        |
| 2      | 0.225      | 0.848          | 0.167    | 0.890        |
| 3      | 0.147      | 0.907          | 0.113    | 0.931        |
| 4      | 0.099      | 0.940          | 0.087    | 0.948        |
| 5      | 0.067      | 0.960          | 0.079    | 0.956        |



8012: 3个方向的加速度数据， 5 epochs 1e-5

test_acc:  <font color='red'>0.953</font>	

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| :----- | :--------- | :------------- | :------- | :----------- |
| 1      | 0.609      | 0.564          | 0.294    | 0.802        |
| 2      | 0.213      | 0.858          | 0.156    | 0.894        |
| 3      | 0.130      | 0.914          | 0.115    | 0.923        |
| 4      | 0.088      | 0.944          | 0.084    | 0.941        |
| 5      | 0.058      | 0.966          | 0.075    | 0.954        |

***

只考虑时序网格

7950:10 epochs, 1e-6,pre

test_acc:<font color='red'> 0.700</font>

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| :----- | :--------- | :------------- | :------- | :----------- |
| 1      | 0.897      | 0.322          | 0.694    | 0.481        |
| 2      | 0.595      | 0.552          | 0.473    | 0.645        |
| 3      | 0.471      | 0.647          | 0.446    | 0.659        |
| 4      | 0.412      | 0.690          | 0.399    | 0.693        |
| 5      | 0.362      | 0.727          | 0.394    | 0.704        |
| 6      | 0.316      | 0.763          | 0.397    | 0.709        |
| 7      | 0.276      | 0.792          | 0.406    | 0.705        |
| 8      | 0.233      | 0.824          | 0.414    | 0.716        |
| 9      | 0.192      | 0.857          | 0.431    | 0.707        |
| 10     | 0.163      | 0.881          | 0.441    | 0.712        |



7951: 10epochs, 1e-5,pre

test_acc:<font color='red'> 0.719</font>

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| :----- | :--------- | :------------- | :------- | :----------- |
| 1      | 0.910      | 0.306          | 0.656    | 0.537        |
| 2      | 0.601      | 0.553          | 0.478    | 0.638        |
| 3      | 0.482      | 0.640          | 0.437    | 0.661        |
| 4      | 0.418      | 0.688          | 0.418    | 0.674        |
| 5      | 0.364      | 0.724          | 0.434    | 0.658        |
| 6      | 0.318      | 0.762          | 0.408    | 0.696        |
| 7      | 0.279      | 0.790          | 0.405    | 0.687        |
| 8      | 0.232      | 0.826          | 0.404    | 0.709        |
| 9      | 0.195      | 0.854          | 0.425    | 0.705        |
| 10     | 0.163      | 0.882          | 0.439    | 0.697        |



8005: 40 epochs, 1e-5,pre

test_acc: <font color='red'>0.707</font>	

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| :----- | :--------- | :------------- | :------- | :----------- |
| 35     | 0.029      | 0.977          | 0.864    | 0.690        |
| 36     | 0.027      | 0.978          | 0.869    | 0.692        |
| 37     | 0.025      | 0.978          | 0.875    | 0.694        |
| 38     | 0.024      | 0.980          | 0.886    | 0.695        |
| 39     | 0.023      | 0.981          | 0.890    | 0.696        |
| 40     | 0.021      | 0.982          | 0.890    | 0.698        |

7960: 10 epochs, 1e-6, npre

test_acc: <font color='red'>0.453</font>

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| :----- | :--------- | :------------- | :------- | :----------- |
| 1      | 0.990      | 0.213          | 0.939    | 0.267        |
| 2      | 0.899      | 0.328          | 0.840    | 0.362        |
| 3      | 0.827      | 0.380          | 0.777    | 0.412        |
| 4      | 0.786      | 0.412          | 0.741    | 0.439        |
| 5      | 0.760      | 0.432          | 0.725    | 0.455        |
| 6      | 0.744      | 0.445          | 0.726    | 0.447        |
| 7      | 0.729      | 0.449          | 0.699    | 0.466        |
| 8      | 0.719      | 0.457          | 0.694    | 0.478        |
| 9      | 0.710      | 0.468          | 0.689    | 0.476        |
| 10     | 0.703      | 0.472          | 0.687    | 0.476        |





7981: 5 epochs, 1e-4, pre (<font color='red'>学习率过大了</font>)



7982: 60 epochs, 1e-6,pre

test_acc: <font color='red'>0.673</font>	

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| :----- | :--------- | :------------- | :------- | :----------- |
| 56     | 0.131      | 0.910          | 0.599    | 0.655        |
| 57     | 0.128      | 0.911          | 0.592    | 0.656        |
| 58     | 0.126      | 0.914          | 0.591    | 0.658        |
| 59     | 0.126      | 0.914          | 0.595    | 0.659        |
| 60     | 0.126      | 0.916          | 0.592    | 0.660        |

8003: 60 epochs, 1e-6, npre

test_acc: <font color='red'>0.636</font>	

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| :----- | :--------- | :------------- | :------- | :----------- |
| 56     | 0.383      | 0.711          | 0.478    | 0.633        |
| 57     | 0.381      | 0.711          | 0.481    | 0.630        |
| 58     | 0.380      | 0.711          | 0.481    | 0.626        |
| 59     | 0.378      | 0.716          | 0.480    | 0.626        |
| 60     | 0.376      | 0.717          | 0.479    | 0.627        |



8009: 80 epochs, 1e-5,pre

test_acc: <font color='red'>0.702</font>	

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| :----- | :--------- | :------------- | :------- | :----------- |
| 76     | 0.019      | 0.982          | 1.073    | 0.687        |
| 77     | 0.019      | 0.982          | 1.079    | 0.688        |
| 78     | 0.019      | 0.982          | 1.081    | 0.690        |
| 79     | 0.019      | 0.983          | 1.083    | 0.690        |
| 80     | 0.018      | 0.984          | 1.083    | 0.688        |

8011: 80 epochs, 1e-5,npre

test_acc: <font color='red'>0.646</font>	

| Epochs | Train Loss | Train Accuracy | Val Loss | Val Accuracy |
| :----- | :--------- | :------------- | :------- | :----------- |
| 76     | 0.025      | 0.977          | 1.191    | 0.645        |
| 77     | 0.024      | 0.978          | 1.204    | 0.645        |
| 78     | 0.024      | 0.979          | 1.213    | 0.644        |
| 79     | 0.022      | 0.980          | 1.216    | 0.649        |
| 80     | 0.022      | 0.981          | 1.217    | 0.649        |

 

8156： 80 epochs, 1e-5,pre



8157:   80 epochs, 1e-6,pre



8158:   60 epochs, 1e-5, pre, dropout=0.6



8164: 10 epochs, 1e-5, gird_num = 1e5
